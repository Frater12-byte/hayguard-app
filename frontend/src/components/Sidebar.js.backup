import React from 'react';
import { Link, useLocation } from 'react-router-dom';
import { useUser } from '../contexts/UserContext';
import { useFarm } from '../contexts/FarmContext';
import ProfilePicture from './ProfilePicture';
import './Sidebar.css';

const Sidebar = ({ collapsed, onToggle }) => {
  const { user } = useUser();
  const { farmData } = useFarm();
  const location = useLocation();

  const menuItems = [
    { path: '/dashboard', icon: '📊', label: 'Dashboard' },
    { path: '/sensors', icon: '🔧', label: 'Sensors' },
    { path: '/reports', icon: '📋', label: 'Reports' },
    { path: '/team', icon: '👥', label: 'Team' },
    { path: '/alerts', icon: '🚨', label: 'Alerts' },
    { path: '/profile', icon: '👤', label: 'Profile' },
    { path: '/settings', icon: '⚙️', label: 'Settings' },
    { path: '/farm-info', icon: '🏡', label: 'My Farm' },
    { path: '/weather', icon: '🌤️', label: 'Weather' },
    { path: '/analytics', icon: '📈', label: 'Analytics' },
  ];

  return (
    <aside className={`sidebar ${collapsed ? 'collapsed' : ''}`}>
      <div className="sidebar-header">
        <ProfilePicture size={collapsed ? 32 : 48} showName={!collapsed} />
      </div>
      
      {/* Farm Info Panel */}
      {!collapsed && (
        <div style={{
          margin: '15px 10px',
          padding: '15px',
          backgroundColor: '#f8f9fa',
          borderRadius: '8px',
          border: '1px solid #e9ecef'
        }}>
          <h4 style={{ 
            margin: '0 0 10px 0', 
            fontSize: '14px', 
            color: '#495057',
            fontWeight: 'bold'
          }}>
            {farmData.name}
          </h4>
          <div style={{ fontSize: '12px', color: '#6c757d' }}>
            <div style={{ marginBottom: '5px' }}>
              📍 {farmData.location.city}, {farmData.location.state}
            </div>
            <div style={{ marginBottom: '5px' }}>
              🌾 {farmData.totalAcres} acres
            </div>
            <div>
              📅 Est. {farmData.establishedYear}
            </div>
          </div>
        </div>
      )}
      
      <nav className="sidebar-nav">
        {menuItems.map(item => (
          <Link 
            key={item.path}
            to={item.path} 
            className={`nav-item ${location.pathname === item.path ? 'active' : ''}`}
          >
            <span className="nav-icon">{item.icon}</span>
            {!collapsed && <span className="nav-label">{item.label}</span>}
          </Link>
        ))}
      </nav>
      
      <button onClick={onToggle} className="collapse-btn">
        {collapsed ? '→' : '←'}
      </button>
    </aside>
  );
};

export default Sidebar;
